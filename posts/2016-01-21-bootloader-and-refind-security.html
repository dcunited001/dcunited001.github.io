<!doctype html>


<!--[if lt IE 7 ]><html itemscope itemtype="http://schema.org/Article" id="ie6" class="ie ie-old" lang="en-US"><![endif]-->
<!--[if IE 7 ]>   <html itemscope itemtype="http://schema.org/Article" id="ie7" class="ie ie-old" lang="en-US"><![endif]-->
<!--[if IE 8 ]>   <html itemscope itemtype="http://schema.org/Article" id="ie8" class="ie ie-old" lang="en-US"><![endif]-->
<!--[if IE 9 ]>   <html itemscope itemtype="http://schema.org/Article" id="ie9" class="ie" lang="en-US"><![endif]-->
<!--[if gt IE 9]><!--><html itemscope itemtype="http://schema.org/Article" lang="en-US"><!--<![endif]-->
<head>



    <!-- Meta -->
    <meta charset="utf-8">

    <title>Bootloader and rEFInd Security ♥ te.xel.io</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <!-- RSS -->
    <link rel="alternate" type="application/rss+xml" title="te.xel.io ♥ " href="/feed.xml">
    <link rel="alternate" type="application/atom+xml" title="te.xel.io ♥ " href="/atom.xml">

    <!-- Favicons -->
    <link rel="shortcut icon" sizes="16x16 24x24 32x32 48x48 64x64 96x96" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="57x57" href="/img/favicons/favicon-57.png">
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="/img/favicons/favicon-57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/img/favicons/favicon-60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/img/favicons/favicon-72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/img/favicons/favicon-76.png">
    <link rel="apple-touch-icon" sizes="96x96" href="/img/favicons/favicon-96.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/img/favicons/favicon-114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/img/favicons/favicon-120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/img/favicons/favicon-144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/img/favicons/favicon-152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/img/favicons/favicon-180.png">
    <link rel="apple-touch-icon" sizes="192x192" href="/img/favicons/favicon-192.png">
    <meta name="application-name" content="te.xel.io ♥ ">
    <meta name="msapplication-TileImage" content="/img/favicons/favicon-144.png">
    <meta name="msapplication-TileColor" content="#ffffff">

    <!-- Fonts -->
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto+Condensed:300,300italic,400,400italic,700,700italic|Oswald:300,400,700">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">

    <!-- Styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!--[if lt IE 9]>
        <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="/js/respond.min.js"></script>
    <![endif]-->
</head>
  <body class="">

    <!-- ganalytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-49910074-1', 'xel.io');
      ga('send', 'pageview');

      var scrollDepthConfig = {}
      ga('require', 'scrollDepthTracker', '/js/scroll-depth-tracker.js', scrollDepthConfig);

      /* scrollDepthTracker defaults
      action : 'Pageview End',
      beacon : true,
      category : 'Page',
      debug : false,
      delay : true,
      labelNoScroll : 'Did Not Scroll',
      labelScroll : 'Did Scroll',
      sampleRate : 100,
      scrollThreshold : 10,
      setPage : true,
      timeout : 300,
      timeThreshold : 15,
      metric : null,
      maxTimeOnPage : 30
      */
    </script>

    <nav id="main-navbar" class="navbar navbar-inverse navbar-fixed-top">
        <div class="container-fluid">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">
                  <span class="navbar-lambda">λ</span>&nbsp;
                  <i class="fa fa-heart"></i>&nbsp;
                  te.xel.io
                </a>
            </div>
            <div id="navbar" class="navbar-collapse collapse">
                <ul class="nav navbar-nav navbar-right">
                    
                        <li><a href="/graphics">3D & Math</a></li>
                    
                        <li><a href="/writing">Writing</a></li>
                    
                        <li><a href="/projects">Projects</a></li>
                    
                        <li><a href="/quotes">Quotes</a></li>
                    
                        <li><a href="/about">About</a></li>
                    
                        <li><a href="/tags">Tags</a></li>
                    
                    <li class="navbar-social">
                      <a href="https://github.com/dcunited001"><i class="fa fa-lg fa-github"></i></a>
                      <a href="https://youtube.com/dcunited001"><i class="fa fa-lg fa-youtube"></i></a>
                      <a href="https://twitter.com/dcunit3d"><i class="fa fa-lg fa-twitter"></i></a>
                      <a href="https://linkedin.com/in/dcunit3d"><i class="fa fa-lg fa-linkedin"></i></a>
                      <a href="https://angel.co/dcunit3d"><i class="fa fa-lg fa-angellist"></i></a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>




<div class="title-group">
  

  <h1 class="special">
    <span>
      
      Bootloader and rEFInd Security
      
    </span>
  </h1>

  
  <aside>
    01.21.16
    
    &middot;
    
    <span>Blog</span>
    
    
  </aside>
  

  <aside>
    <span class="title-subglyph">
      &nbsp;(&nbsp;λ&nbsp;<i class="fa fa-heart"></i>
      <a href="#" id="btn-subglyph" onclick="toggleSubglyph()" data-toggle="tooltip" title="Click Me To Escape Index-Based Censorship">§µßƍŁ¥þĦ</a>
      )&nbsp;
    </span>
  </aside>
</div>


<div class="container">

  <article>
    <section class="article-content">
      <div class="row">
        <div class="col-md-10 col-md-offset-1">
          <p>To properly implement rEFInd, this means <em>you need to know what
you’re doing</em>, especially if your security requires more than usual
concern.  Otherwise, you’re completely exposing super-root access to
your laptop.</p>

<p>I cannot underscore the importance of these, if security is a top
priority.  If it is, you should really not be running rEFInd.  You
should have a single bootable OS, with a minimal bootloader and you
should be using Secure Boot.</p>

<blockquote>
  <p>Plz Note: this list should not be considered exhaustive, nor
should this post be considered authoritative.  I’m just learning
about bootloaders myself.  But this is a good starting point.</p>
</blockquote>

<p>I should also note that configuring all these correctly is a pain.
It will require entering two passwords before you get to your OS
password.</p>

<h2 id="general-password-security-notes">General Password Security Notes</h2>

<p>For many, using a password manager sounds overly complicated,
especially one that’s not sync’d to the cloud.  However, I can assure
you, it’s actually way simpler. Just trust me. Everyone needs a
variable degree of privacy, but it’s important to know what
protections your process actually gives you.</p>

<blockquote>
  <p>Don’t let someone own all your bases at once.</p>
</blockquote>

<p>In general: use distinct passwords for LUKS, disk-encryption, password
safes, OS users and OS Super Users.  This provides proper security
through compartmentalization.</p>

<p>Furthermore, compartmentalize your use of a password manager by
creating multiple files (with separate keys!) and secure access to
these files <em>physically</em>.  That is, separate your most important
passwords (GMail, etc) from the rest of your passwords.  If you have
passwords for work or whatever, don’t store them all in one place.</p>

<p>Don’t store these password files on your computer and definitely not
in the cloud.  Instead, store the most crucial ones on a
LUKS-encrypted USB drive.  Or use a YubiKey, properly configured.</p>

<h2 id="signing-your-efi-bootloader">(1) Signing your EFI bootloader!</h2>

<p>If your bootloader is not signed, it can be modified.  This means a
malicious program could make modifications to your kernel images, in
memory, before your OS fully loads.  For OSX, Linux or Windows, this
means that arbitrary code could be loaded at the OS level as you’re
booting.  This can wreak all kinds of havoc and/or mute any
protections you might think you have.</p>

<h2 id="configuring-secure-boot">(2) Configuring Secure Boot!</h2>

<p>This involves signing your bootloader and configuring UEFI to reject
bootloaders that don’t hash out…</p>

<h2 id="restricting-your-uefi-boot-devices">(3) Restricting your UEFI boot devices!</h2>

<p>Someone who attains root access in an install can alter/update the
UEFI boot order or trigger an alternate UEFI boot.  This means they
can boot from CD/USB or whatever.  So even if you do not have
vulnerabilities in your systems configured, they can attain access
through an external linux ISO.  If you’ve configured things correctly,
this should not provide them with any more options.</p>

<h2 id="limiting-your-efieefind-boot-options">(4) Limiting your EFI/eEFInd boot options!</h2>

<p>There are several problematic defaults for rEFInd, but which are
needed for newbs.  For example, if you don’t restrict rEFInd boot
options, rEFInd scans accessible disks for bootable images.  Any of
these images can be booted.  You can configure rEFInd to allow users
to alter arguments passed to bootable images (partition, luks options,
etc.)  This is a very helpful option if you’re learning about this
stuff, but also another avenue for an adversary with physical access.
And rEFInd offers other tools like MOKS and other options which are
enabled by default.  After you’ve got your bootloader set and signed,
you need to disable this stuff.</p>

<h2 id="utilizing-whole-disk-encryption-luks">(5) Utilizing whole-disk encryption (LUKS)!</h2>

<p>If you’re not using LUKS whole-disk encryption, this means anyone who
has 10 minutes access to your laptop can access rEFInd.  Using LUKS
should prompt you for a password before you can boot into rEFInd.</p>

<h2 id="encrypting-your-individual-partitions">(6) Encrypting your individual partitions!</h2>

<p>If your disks are not encrypted, they are full accessible to any
OS/program than can be booted from EFI.  This means if you have a
linux install that you’re just messing with, someone could obtain
access to all your OSX data, if that partition is not encrypted.
Using disk encryption for individual partitions means that you should
be prompted for a password before you boot into an OS from rEFInd.
That’s a second password, before you get to your OS password.</p>

<h2 id="consistent-partition-table">(7) Consistent Partition Table</h2>

<p>When working with an existing OSX installation, you can end up with
a hybrid partition table, which is confusing.  You may need to image
your partitions and reload them.</p>

<h2 id="retaining-access-to-your-macs-restore-partition">(8) Retaining access to your Mac’s Restore Partition!</h2>

<p>If things go wrong, you’re going to want access to the restore
partition, as it provides alot of tools for troubleshooting these
problems, especially with regard to OSX and Mac hardware.
It really sucks to not have this when you need it.</p>

<h2 id="while-not-locking-yourself-out-of-refind">(9) While not locking yourself out of rEFInd!</h2>

<p>Retain a bootloader backup that can be used in case you hose
your.  If you can’t boot into rEFInd, you’re going to have to
get creative to restore it.  This means backing up your EFI
partition and getting access to change your UEFI boot order.</p>

<p>I think.  Haven’t gone through this myself.  Like I said.  I’m not an
expert here.</p>

<h2 id="using-distinct-keys-for-luks-encryption-and-passwords">(10) Using distinct keys for LUKS, Encryption and Passwords</h2>

<p>Your individual partitions should not be encrypted with the same key.
You can’t access a password manager at boot time.  You should not
reuse your LUKS key or any of your disk encryption keys as passwords
anywhere else.  Disk encryption is not very secure, especially if
adversaries have physical access or can image sections of your disk
multiple times.</p>

<p>That’s all I can think of for now. Leave a comment below if you’d
like to discuss.</p>


        </div>
      </div>
    </section>

    <section class="comments">
      
<div id="disqus_thread"></div>
<script type="text/javascript">
  window.disqus_identifier="";
  window.disqus_url="https://te.xel.io//posts/2016-01-21-bootloader-and-refind-security.html";
  window.disqus_title="Bootloader and rEFInd Security";
</script>
<script type="text/javascript" src="https://disqus.com/forums/te-xel-io/embed.js"></script>
<noscript><a href="https://te-xel-io.disqus.com/?url=ref">View the discussion thread.</a></noscript>


    </section>

  </article>

</div>

    <footer class="site-footer">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                  <p class="text-muted">
                    dconner.pro@gmail.com&nbsp; &copy; 2019
                    &nbsp;<a href="/feed.xml"><i class="fa fa-rss-square"></i></a>
                    &nbsp;<a href="/atom.xml"><i class="fa fa-rss"></i></a>
                  </p>
                </div>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <script src="/js/tagcanvas.min.js" type="text/javascript"></script>
    <script src="/js/underscore.js"></script>

    

    <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
    <script src="/js/subglyph/subglyph.js" type="text/javascript"></script>

    <!-- load remotely -->
    <script src="http://te.xel.io/js/subglyph/subglyph-dictionary.js" type="text/javascript" charset="UTF-16"></script>

    <script>
      var btnSubglyph = $('#btn-subglyph');
      btnSubglyph.tooltip();

      subglyph = new Subglyph({
        dictionary: SUBGLYPH_DEFAULTS
      });

      toggleSubglyph = function() {
        var article = document.getElementsByTagName('article')[0];
        var newArticleHTML = subglyph.glyphIt(article);
        article.innerHTML = newArticleHTML;
      }
    </script>
    </body>
</html>

